{"title":"Go-Test-Convey使用","uid":"7197218ba2b31b3e36651d378424a532","slug":"Go-Test-Convey使用","date":"2022-11-14T11:53:51.000Z","updated":"2022-11-14T11:53:51.655Z","comments":true,"path":"api/articles/Go-Test-Convey使用.json","keywords":null,"cover":[],"content":"<p><a href=\"https://github.com/smartystreets/goconvey\">Convey</a><br><a href=\"https://github.com/smartystreets/goconvey/wiki\">Wiki</a></p>\n<p>Feature:</p>\n<ul>\n<li>直接与  <code>go test</code> 集成</li>\n<li>全自动的 WEBUI(与 go test 一起工作)</li>\n<li>大量的回归测试</li>\n<li>展示测试覆盖率</li>\n<li>可读的,彩色控制台输出(可以被其他人理解)</li>\n<li>测试代码自动生成</li>\n<li>桌面通知(optional)</li>\n<li>立即打开问题行.</li>\n</ul>\n<span id=\"more\"></span>\n\n\n\n<h2 id=\"1-Why-goconvey\"><a href=\"#1-Why-goconvey\" class=\"headerlink\" title=\"1. Why goconvey\"></a>1. Why goconvey</h2><p>Goconvey 提供了人性化的断言使用方式, 优雅的写出测试代码, 同时能够在终端输出彩色的测试结果,还支持WebUI查看</p>\n<h2 id=\"2-断言使用\"><a href=\"#2-断言使用\" class=\"headerlink\" title=\"2. 断言使用\"></a>2. 断言使用</h2><h3 id=\"2-1-普通判等\"><a href=\"#2-1-普通判等\" class=\"headerlink\" title=\"2.1. 普通判等\"></a>2.1. 普通判等</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldEqual<span class=\"token punctuation\">,</span> thing2<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldNotEqual<span class=\"token punctuation\">,</span> thing2<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldResemble<span class=\"token punctuation\">,</span> thing2<span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">// a deep equals for arrays, slices, maps, and structs</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldNotResemble<span class=\"token punctuation\">,</span> thing2<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldPointTo<span class=\"token punctuation\">,</span> thing2<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldNotPointTo<span class=\"token punctuation\">,</span> thing2<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldBeNil<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldNotBeNil<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldBeTrue<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldBeFalse<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>thing1<span class=\"token punctuation\">,</span> ShouldBeZeroValue<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h3 id=\"2-2-数值类型比较\"><a href=\"#2-2-数值类型比较\" class=\"headerlink\" title=\"2.2. 数值类型比较\"></a>2.2. 数值类型比较</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ShouldBeGreaterThan<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ShouldBeGreaterThanOrEqualTo<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ShouldBeLessThan<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ShouldBeLessThanOrEqualTo<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> ShouldBeBetween<span class=\"token punctuation\">,</span> <span class=\"token number\">.8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> ShouldNotBeBetween<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> ShouldBeBetweenOrEqual<span class=\"token punctuation\">,</span> <span class=\"token number\">.9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> ShouldNotBeBetweenOrEqual<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> ShouldAlmostEqual<span class=\"token punctuation\">,</span> <span class=\"token number\">0.99999999</span><span class=\"token punctuation\">,</span> <span class=\"token number\">.0001</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\">// tolerance is optional; default 0.0000000001</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> ShouldNotAlmostEqual<span class=\"token punctuation\">,</span> <span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">.0001</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h3 id=\"2-3-集合类型\"><a href=\"#2-3-集合类型\" class=\"headerlink\" title=\"2.3. 集合类型\"></a>2.3. 集合类型</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldContain<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldNotContain<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> ShouldBeIn<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> ShouldNotBeIn<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldBeEmpty<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldNotBeEmpty<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldContainKey<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldNotContainKey<span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldNotBeEmpty<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldBeEmpty<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> ShouldHaveLength<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// supports map, slice, chan, and string</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h3 id=\"2-4-字符串\"><a href=\"#2-4-字符串\" class=\"headerlink\" title=\"2.4. 字符串\"></a>2.4. 字符串</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">,</span> ShouldStartWith<span class=\"token punctuation\">,</span> <span class=\"token string\">\"as\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">,</span> ShouldNotStartWith<span class=\"token punctuation\">,</span> <span class=\"token string\">\"df\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">,</span> ShouldEndWith<span class=\"token punctuation\">,</span> <span class=\"token string\">\"df\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">,</span> ShouldNotEndWith<span class=\"token punctuation\">,</span> <span class=\"token string\">\"df\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">,</span> ShouldContainSubstring<span class=\"token punctuation\">,</span> <span class=\"token string\">\"sd\"</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">// optional 'expected occurences' arguments?</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">,</span> ShouldNotContainSubstring<span class=\"token punctuation\">,</span> <span class=\"token string\">\"er\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"adsf\"</span><span class=\"token punctuation\">,</span> ShouldBeBlank<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">,</span> ShouldNotBeBlank<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h3 id=\"2-5-panic\"><a href=\"#2-5-panic\" class=\"headerlink\" title=\"2.5. panic\"></a>2.5. panic</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldPanic<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldNotPanic<span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldPanicWith<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">// or errors.New(\"something\")</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldNotPanicWith<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">// or errors.New(\"something\")</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h3 id=\"2-6-类型检查\"><a href=\"#2-6-类型检查\" class=\"headerlink\" title=\"2.6. 类型检查\"></a>2.6. 类型检查</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ShouldHaveSameTypeAs<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ShouldNotHaveSameTypeAs<span class=\"token punctuation\">,</span> <span class=\"token string\">\"asdf\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n\n<h3 id=\"2-7-时间类型\"><a href=\"#2-7-时间类型\" class=\"headerlink\" title=\"2.7. 时间类型\"></a>2.7. 时间类型</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldHappenBefore<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldHappenOnOrBefore<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldHappenAfter<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldHappenOnOrAfter<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldHappenBetween<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldHappenOnOrBetween<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldNotHappenOnOrBetween<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldHappenWithin<span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">So</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldNotHappenWithin<span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h2 id=\"3-Convey-使用\"><a href=\"#3-Convey-使用\" class=\"headerlink\" title=\"3. Convey 使用\"></a>3. Convey 使用</h2><h3 id=\"3-1\"><a href=\"#3-1\" class=\"headerlink\" title=\"3.1\"></a>3.1</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\">\n<span class=\"token keyword\">func</span> <span class=\"token function\">StringSliceEqual</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">bool</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token function\">len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token function\">len</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">==</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">==</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> v <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> a <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">if</span> v <span class=\"token operator\">!=</span> b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">TestStringSliceEqual</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\n\t<span class=\"token function\">Convey</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TestStringSliceEqual should return true when a != nil  &amp;&amp; b != nil\"</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\ta <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"convey\"</span><span class=\"token punctuation\">&#125;</span>\n\t\tb <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"convey1\"</span><span class=\"token punctuation\">&#125;</span>\n\t\t<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token function\">StringSliceEqual</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldBeTrue<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"3-2-Convey-语句的嵌套\"><a href=\"#3-2-Convey-语句的嵌套\" class=\"headerlink\" title=\"3.2 Convey 语句的嵌套\"></a>3.2 Convey 语句的嵌套</h3><pre class=\"line-numbers language-go\" data-language=\"go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">TestStringSliceEqual</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\n\t<span class=\"token function\">Convey</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TestStringSliceEqual\"</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token function\">Convey</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should return true when a != nil  &amp;&amp; b != nil\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\ta <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"goconvey\"</span><span class=\"token punctuation\">&#125;</span>\n\t\t\tb <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"goconvey\"</span><span class=\"token punctuation\">&#125;</span>\n\t\t\t<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token function\">StringSliceEqual</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldBeTrue<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n\n\t\t<span class=\"token function\">Convey</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should return true when a ＝= nil  &amp;&amp; b ＝= nil\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token function\">StringSliceEqual</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldBeTrue<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n\n\t\t<span class=\"token function\">Convey</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should return false when a ＝= nil  &amp;&amp; b != nil\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\ta <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">nil</span><span class=\"token punctuation\">)</span>\n\t\t\tb <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span>\n\t\t\t<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token function\">StringSliceEqual</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldBeFalse<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n\n\t\t<span class=\"token function\">Convey</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should return false when a != nil  &amp;&amp; b != nil\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\ta <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"world\"</span><span class=\"token punctuation\">&#125;</span>\n\t\t\tb <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"goconvey\"</span><span class=\"token punctuation\">&#125;</span>\n\t\t\t<span class=\"token function\">So</span><span class=\"token punctuation\">(</span><span class=\"token function\">StringSliceEqual</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ShouldBeFalse<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#125;</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>只有最外层的  Convey 需要传入 <code>*testing.T</code></li>\n</ul>\n<h2 id=\"4-最佳实践\"><a href=\"#4-最佳实践\" class=\"headerlink\" title=\"4. 最佳实践\"></a>4. 最佳实践</h2><ol>\n<li><code>import goconvey</code>包时，前面加点号”.”，以减少冗余的代码.凡是在测试代码中看到Convey和So两个方法,肯定是convey包的,不要在产品代码中定义相同的函数名</li>\n<li>测试函数的名字必须以Test开头，而且参数类型必须为<code>*testing.T</code></li>\n<li>每个测试用例必须使用Convey函数包裹起来</li>\n</ol>\n<ul>\n<li>它的第一个参数为string类型的测试描述</li>\n<li>第二个参数为测试函数的入参(类型为<code>*testing.T</code>)</li>\n<li>第三个参数为不接收任何参数也不返回任何值的函数(习惯使用闭包)</li>\n</ul>\n<ol start=\"4\">\n<li>Convey函数的第三个参数闭包的实现中通过So函数完成断言判断,</li>\n</ol>\n<ul>\n<li>第一个参数为实际值</li>\n<li>第二个参数为断言函数变量</li>\n<li>第三个参数或者没有(当第二个参数为类ShouldBeTrue形式的函数变量)或者有(当第二个函数为类ShouldEqual形式的函数变量)</li>\n</ul>\n<ol start=\"5\">\n<li>使用嵌套的形式包裹多个测试用例, 输出结果看起来优雅</li>\n</ol>\n<h2 id=\"5-WebUI\"><a href=\"#5-WebUI\" class=\"headerlink\" title=\"5.  WebUI\"></a>5.  WebUI</h2><p>在 test文件所在目录下执行  <code>$GOBIN/goconvey</code> 命令</p>\n<p>之后可以通过 <code>localhost:8080</code> 查看webUI界面</p>\n<p><img src=\"http://d79i1fxsrar4t.cloudfront.net/goconvey.co/gc-1-dark.png\"></p>\n<p>[参考]</p>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/e3b2b1194830\">GoConvey框架使用指南</a></li>\n<li><a href=\"https://www.liwenzhou.com/posts/Go/golang-unit-test-5/\">Go单测从零到溜系列5—goconvey的使用</a></li>\n</ul>\n","text":"ConveyWiki Feature: 直接与 go test 集成 全自动的 WEBUI(与 go test 一起工作) 大量的回归测试 展示测试覆盖率 可读的,彩色控制台输出(可以被其他人理解) 测试代码自动生成 桌面通知(optional) 立即打开问题行. 1. Why ...","link":"","photos":[],"count_time":{"symbolsCount":"4.9k","symbolsTime":"4 mins."},"categories":[{"name":"golang","slug":"golang","count":4,"path":"api/categories/golang.json"}],"tags":[{"name":"golang","slug":"golang","count":9,"path":"api/tags/golang.json"},{"name":"test","slug":"test","count":4,"path":"api/tags/test.json"},{"name":"convey","slug":"convey","count":1,"path":"api/tags/convey.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-Why-goconvey\"><span class=\"toc-text\">1. Why goconvey</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E6%96%AD%E8%A8%80%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">2. 断言使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-1-%E6%99%AE%E9%80%9A%E5%88%A4%E7%AD%89\"><span class=\"toc-text\">2.1. 普通判等</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83\"><span class=\"toc-text\">2.2. 数值类型比较</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-3-%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B\"><span class=\"toc-text\">2.3. 集合类型</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-4-%E5%AD%97%E7%AC%A6%E4%B8%B2\"><span class=\"toc-text\">2.4. 字符串</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-5-panic\"><span class=\"toc-text\">2.5. panic</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-6-%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5\"><span class=\"toc-text\">2.6. 类型检查</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-7-%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B\"><span class=\"toc-text\">2.7. 时间类型</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-Convey-%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">3. Convey 使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-1\"><span class=\"toc-text\">3.1</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-2-Convey-%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%B5%8C%E5%A5%97\"><span class=\"toc-text\">3.2 Convey 语句的嵌套</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5\"><span class=\"toc-text\">4. 最佳实践</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#5-WebUI\"><span class=\"toc-text\">5.  WebUI</span></a></li></ol>","author":{"name":"majm","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"技术分享","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Go-Test-Gomonkey使用","uid":"03cc55fb6473717cac5c2d4cd07b1cc0","slug":"Go-Test-Gomonkey使用","date":"2022-11-14T11:54:08.000Z","updated":"2022-11-14T11:54:08.621Z","comments":true,"path":"api/articles/Go-Test-Gomonkey使用.json","keywords":null,"cover":null,"text":"golang的单测, 有一些约定, 例如文件名是 xxx.go, 测试文件名必须是 xxx_test.go, 且测试函数的方法名 都是以 Test开头, 使用go test 命令, 有时发现mock不住,一般都是内联(简短)函数mock失败,可以执行的时候加上编译条件禁止内联 -...","link":"","photos":[],"count_time":{"symbolsCount":"7.6k","symbolsTime":"7 mins."},"categories":[{"name":"golang","slug":"golang","count":4,"path":"api/categories/golang.json"}],"tags":[{"name":"golang","slug":"golang","count":9,"path":"api/tags/golang.json"},{"name":"test","slug":"test","count":4,"path":"api/tags/test.json"},{"name":"gomonkey","slug":"gomonkey","count":1,"path":"api/tags/gomonkey.json"}],"author":{"name":"majm","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"技术分享","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Go-Test-gomock使用","uid":"301b2e78436f0e9c40fa9a9acf52a404","slug":"Go-Test-gomock使用","date":"2022-11-14T11:53:38.000Z","updated":"2022-11-14T11:53:38.199Z","comments":true,"path":"api/articles/Go-Test-gomock使用.json","keywords":null,"cover":null,"text":"写出可测试 的代码 至关重要. 可以保证代码的稳定性. 帮助程序员减少bug. gomock 是一个go官方的模拟框架.gomock的使用场景: IO类型的数据, 本地文件,数据库,网络API,RPC等 依赖的服务还没有开发好, 这时候可以自己模拟一个服务, 加快开发进度提升开发...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"golang","slug":"golang","count":4,"path":"api/categories/golang.json"}],"tags":[{"name":"golang","slug":"golang","count":9,"path":"api/tags/golang.json"},{"name":"test","slug":"test","count":4,"path":"api/tags/test.json"},{"name":"gomock","slug":"gomock","count":1,"path":"api/tags/gomock.json"}],"author":{"name":"majm","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"技术分享","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}