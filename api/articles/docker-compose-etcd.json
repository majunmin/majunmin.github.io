{"title":"docker-compose etcd","uid":"2c7dd58c559020b938dd674699ae2dad","slug":"docker-compose-etcd","date":"2022-06-20T08:53:05.000Z","updated":"2022-06-20T09:00:41.662Z","comments":true,"path":"api/articles/docker-compose-etcd.json","keywords":null,"cover":[],"content":"<h2 id=\"code\"><a href=\"#code\" class=\"headerlink\" title=\"code\"></a>code</h2><p><strong>docker-compose.yml</strong></p>\n<span id=\"more\"></span>\n\n<pre class=\"line-numbers language-yml\" data-language=\"yml\"><code class=\"language-yml\">version: &#39;3&#39;\n\nnetworks:\n  etcd-net:\n    driver: bridge # 网桥模式\n\nvolumes:\n  etcd1_data:       # 挂在到 本地数据卷 名\n    driver: local\n  etcd2_data:\n    driver: local\n  etcd3_data:\n    driver: local\n\nservices:\n  etcd1:\n    image: docker.io&#x2F;bitnami&#x2F;etcd:3\n    container_name: etcd1\n    restart: always\n    networks:\n      - etcd-net\n    ports:\n      - &quot;20000:2379&quot;\n      - &quot;20001:2380&quot;\n    environment:\n      - ALLOW_NONE_AUTHENTICATION&#x3D;yes\n      - ETCD_NAME&#x3D;etcd1\n      - ETCD_INITIAL_ADVERTISE_PEER_URLS&#x3D;http:&#x2F;&#x2F;etcd1:2380\n      - ETCD_LISTEN_PEER_URLS&#x3D;http:&#x2F;&#x2F;0.0.0.0:2380\n      - ETCD_LISTEN_CLIENT_URLS&#x3D;http:&#x2F;&#x2F;0.0.0.0:2379\n      - ETCD_ADVERTISE_CLIENT_URLS&#x3D;http:&#x2F;&#x2F;etcd1:2379\n      - ETCD_INITIAL_CLUSTER_TOKEN&#x3D;etcd-cluster\n      - ETCD_INITIAL_CLUSTER&#x3D;etcd1&#x3D;http:&#x2F;&#x2F;etcd1:2380,etcd2&#x3D;http:&#x2F;&#x2F;etcd2:2380,etcd3&#x3D;http:&#x2F;&#x2F;etcd3:2380\n      - ETCD_INITIAL_CLUSTER_STATE&#x3D;new\n    volumes:\n      - etcd1_data:&#x2F;bitnami&#x2F;etcd\n  etcd2:\n    image: docker.io&#x2F;bitnami&#x2F;etcd:3\n    container_name: etcd2\n    restart: always\n    networks:\n      - etcd-net\n    ports:\n      - &quot;20002:2379&quot;\n      - &quot;20003:2380&quot;\n    environment:\n      - ALLOW_NONE_AUTHENTICATION&#x3D;yes\n      - ETCD_NAME&#x3D;etcd2\n      - ETCD_INITIAL_ADVERTISE_PEER_URLS&#x3D;http:&#x2F;&#x2F;etcd2:2380\n      - ETCD_LISTEN_PEER_URLS&#x3D;http:&#x2F;&#x2F;0.0.0.0:2380\n      - ETCD_LISTEN_CLIENT_URLS&#x3D;http:&#x2F;&#x2F;0.0.0.0:2379\n      - ETCD_ADVERTISE_CLIENT_URLS&#x3D;http:&#x2F;&#x2F;etcd2:2379\n      - ETCD_INITIAL_CLUSTER_TOKEN&#x3D;etcd-cluster\n      - ETCD_INITIAL_CLUSTER&#x3D;etcd1&#x3D;http:&#x2F;&#x2F;etcd1:2380,etcd2&#x3D;http:&#x2F;&#x2F;etcd2:2380,etcd3&#x3D;http:&#x2F;&#x2F;etcd3:2380\n      - ETCD_INITIAL_CLUSTER_STATE&#x3D;new\n    volumes:\n      - etcd2_data:&#x2F;bitnami&#x2F;etcd\n  etcd3:\n    image: docker.io&#x2F;bitnami&#x2F;etcd:3\n    container_name: etcd3\n    restart: always\n    networks:\n      - etcd-net\n    ports:\n      - &quot;20004:2379&quot;\n      - &quot;20005:2380&quot;\n    environment:\n      - ALLOW_NONE_AUTHENTICATION&#x3D;yes\n      - ETCD_NAME&#x3D;etcd3\n      - ETCD_INITIAL_ADVERTISE_PEER_URLS&#x3D;http:&#x2F;&#x2F;etcd3:2380\n      - ETCD_LISTEN_PEER_URLS&#x3D;http:&#x2F;&#x2F;0.0.0.0:2380\n      - ETCD_LISTEN_CLIENT_URLS&#x3D;http:&#x2F;&#x2F;0.0.0.0:2379\n      - ETCD_ADVERTISE_CLIENT_URLS&#x3D;http:&#x2F;&#x2F;etcd3:2379\n      - ETCD_INITIAL_CLUSTER_TOKEN&#x3D;etcd-cluster\n      - ETCD_INITIAL_CLUSTER&#x3D;etcd1&#x3D;http:&#x2F;&#x2F;etcd1:2380,etcd2&#x3D;http:&#x2F;&#x2F;etcd2:2380,etcd3&#x3D;http:&#x2F;&#x2F;etcd3:2380\n      - ETCD_INITIAL_CLUSTER_STATE&#x3D;new\n    volumes:\n      - etcd3_data:&#x2F;bitnami&#x2F;etcd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h2 id=\"运行\"><a href=\"#运行\" class=\"headerlink\" title=\"运行\"></a>运行</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">docker-compose up -d<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"查看运行状态\"><a href=\"#查看运行状态\" class=\"headerlink\" title=\"查看运行状态\"></a>查看运行状态</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">docker ps\n\ndocket inspect etcd1\n\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/majunmin/image/etcd/20220620165715.png\"></p>\n<hr>\n<p>[参考]<br><a href=\"https://github.com/bitnami/bitnami-docker-etcd\">bitnami-docker-etcd</a><br><a href=\"https://www.qetool.com/scripts/view/19416.html\">docker-compose 部署etcd集群</a></p>\n","text":"codedocker-compose.yml version: &#39;3&#39; networks: etcd-net: driver: bridge # 网桥模式 volumes: etcd1_data: # 挂在到 本地数据卷 名 driver: local etcd2...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"docker","slug":"docker","count":2,"path":"api/tags/docker.json"},{"name":"docker-compose","slug":"docker-compose","count":1,"path":"api/tags/docker-compose.json"},{"name":"etcd","slug":"etcd","count":1,"path":"api/tags/etcd.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#code\"><span class=\"toc-text\">code</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%90%E8%A1%8C\"><span class=\"toc-text\">运行</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81\"><span class=\"toc-text\">查看运行状态</span></a></li></ol>","author":{"name":"majm","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"技术分享","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"grpc-DNSResolver","uid":"c648812ee90e87a774c05f7906322d9f","slug":"grpc-DNSResolver","date":"2022-06-21T02:58:26.000Z","updated":"2022-10-11T04:01:20.168Z","comments":true,"path":"api/articles/grpc-DNSResolver.json","keywords":null,"cover":null,"text":" Coderesolver/resolver.go package resolver import ( \"context\" \"net\" \"net/url\" \"google.golang.org/grpc/attributes\" \"google.golang.org/grpc/cr...","link":"","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[],"tags":[{"name":"DNSResolver","slug":"DNSResolver","count":1,"path":"api/tags/DNSResolver.json"},{"name":"grpc","slug":"grpc","count":1,"path":"api/tags/grpc.json"}],"author":{"name":"majm","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"技术分享","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"golang ChecksumMismath Problem Resolve","uid":"bcbdd392335684c9104bdd4f64660df8","slug":"golang-ChecksumMismath-Problem-Resolve","date":"2022-03-04T10:31:53.000Z","updated":"2022-08-31T08:29:25.613Z","comments":true,"path":"api/articles/golang-ChecksumMismath-Problem-Resolve.json","keywords":null,"cover":null,"text":"","link":"","photos":[],"count_time":{"symbolsCount":0,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"majm","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"技术分享","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}